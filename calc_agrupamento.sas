LIBNAME JONY '/home/u63480479/my_shared_file_links/u63480479';

DATA JONY.BASE_ANALISE_202310;
INPUT NOME $ ID CANAL $ SAFRA VALORES_ORIGINAL;
DATALINES;
Joao 1 MOBILE 202310 100
Maria 2 INTERNET 202310 150
Carlos 3 AGENCIA 202310 200
Ana 4 MOBILE 202310 120
Pedro 5 INTERNET 202310 180
Luis 6 AGENCIA 202310 220
Fernanda 7 MOBILE 202310 90
Rafael 8 INTERNET 202310 130
Julia 9 AGENCIA 202310 190
Gustavo 10 MOBILE 202310 110
Camila 11 INTERNET 202310 160
Marcos 12 AGENCIA 202310 210
Mariana 13 MOBILE 202310 80
Diego 14 INTERNET 202310 140
Isabela 15 AGENCIA 202310 200
Rodrigo 16 MOBILE 202310 95
Renata 17 INTERNET 202310 145
Lucas 18 AGENCIA 202310 205
Beatriz 19 MOBILE 202310 105
Thiago 20 INTERNET 202310 170
;
RUN;

/*DATA JONY.BASE_ANALISE_202309;*/
/*INPUT NOME $ ID CANAL $ SAFRA VALORES_ORIGINAL;*/
/*DATALINES;*/
/*Jony 1 MOBILE 202309 300*/
/*Andreia 2 INTERNET 202309 150*/
/*Gustavo 3 AGENCIA 202309 200*/
/*Luiza 4 MOBILE 202309 280*/
/*Rodrigo 5 INTERNET 202309 190*/
/*Patricia 6 AGENCIA 202309 290*/
/*Joaquim 7 MOBILE 202309 110*/
/*Isabela 8 INTERNET 202309 130*/
/*Diego 9 AGENCIA 202309 190*/
/*Fernanda 10 MOBILE 202309 400*/
/*Marcos 11 INTERNET 202309 160*/
/*Carla 12 AGENCIA 202309 510*/
/*Renato 13 MOBILE 202309 180*/
/*Mariana 14 INTERNET 202309 190*/
/*Guilherme 15 AGENCIA 202309 200*/
/*Carolina 16 MOBILE 202309 195*/
/*Rafael 17 INTERNET 202309 245*/
/*Camila 18 AGENCIA 202309 205*/
/*Leonardo 19 MOBILE 202309 105*/
/*Ana 20 INTERNET 202309 170*/
/*;*/
/*RUN;*/


DATA JUNCAO;
/*SET JONY.BASE_ANALISE_202309*/
SET	JONY.BASE_ANALISE_202310
;
RUN;


DATA JONY.DADOS_INPUT;
INPUT ID SAFRA VALORES_PAGO;
DATALINES;
1 202309 50
2 202309 75
3 202309 100
4 202309 60
5 202309 90
6 202310 110
7 202309 45
8 202309 65
9 202310 95
10 202310 55
11 202309 80
12 202310 105
13 202309 40
14 202309 70
15 202310 100
16 202309 48
17 202309 72
18 202309 102
19 202310 52
20 202310 85
    ;
RUN;


PROC SQL;
	CREATE TABLE ANALITICO AS SELECT 
		 B.VALORES_PAGO/A.VALORES_ORIGINAL * 100 AS PERC
		,A.ID
		,A.VALORES_ORIGINAL
		,B.VALORES_PAGO
		,A.SAFRA
		,A.CANAL
	FROM JUNCAO AS A 
	LEFT JOIN DADOS_INPUT AS B ON A.ID = B.ID 
	WHERE A.SAFRA = B.SAFRA
;

PROC SQL;
	CREATE TABLE CUBO AS SELECT 
		A.CANAL
		,MEAN(a.perc) as media_perc
	from analitico AS A
	GROUP BY A.CANAL
	;
quit;




