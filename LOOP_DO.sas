LIBNAME JONY '/home/u63480479/my_shared_file_links/u63480479';

%MACRO MACRO_TRATAMENTO(INICIO, FIM);
	%DO I = &INICIO. %TO &FIM.;
		%LET NOME_BASE = JUNCAO_&I.;
		%LET FR = BASE_ANALISE_&I.;
		PROC SQL;
			CREATE TABLE &NOME_BASE. AS SELECT
				A.ID
				,CANAL
				,B.VALORES_PAGO/A.VALORES_ORIGINAL AS CALC
			FROM JONY.&FR. AS A
			LEFT JOIN JONY.DADOS_INPUT AS B ON A.ID = B.ID
			;
		QUIT;
	%END;
%MEND;

%MACRO_TRATAMENTO(202309, 202310);


DATA JONY.BASE_ANALISE_202308;
INPUT NOME $ ID CANAL $ SAFRA VALORES_ORIGINAL;
DATALINES;
Joao 1 MOBILE 202310 100
Maria 2 INTERNET 202310 150
Carlos 3 AGENCIA 202310 200
Ana 4 MOBILE 202310 120
Pedro 5 INTERNET 202310 180
Luis 6 AGENCIA 202310 220
Fernanda 7 MOBILE 202310 90
Rafael 8 INTERNET 202310 130
Julia 9 AGENCIA 202310 190
Gustavo 10 MOBILE 202310 110
Camila 11 INTERNET 202310 160
Marcos 12 AGENCIA 202310 210
Mariana 13 MOBILE 202310 80
Diego 14 INTERNET 202310 140
Isabela 15 AGENCIA 202310 200
Rodrigo 16 MOBILE 202310 95
Renata 17 INTERNET 202310 145
Lucas 18 AGENCIA 202310 205
Beatriz 19 MOBILE 202310 105
Thiago 20 INTERNET 202310 170
;
RUN;

%MACRO JUNTANDO_BASE(INICIO, FIM);
	%DO I = &INICIO. %TO &FIM.;
		%LET NOME_BASE = BASE_ANALISE_&I.
		DATA BASE_ANALISE_F;
		SET BASE_ANALISE_F
			JONY.&NOME_BASE.
		;
		RUN;
	%END;
%MEND;

%JUNTANDO_BASE(202308, 202310);

